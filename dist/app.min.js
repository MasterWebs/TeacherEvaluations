angular.module("EvalApp",["ngRoute"]).config(["$routeProvider",function(a){a.when("/login",{templateUrl:"views/login.html",controller:"LoginController"}).when("/student",{templateUrl:"views/student-frontpage.html",controller:"StudentController"}).when("/admin",{templateUrl:"views/admin-frontpage.html",controller:"AdminController"}).otherwise({redirectTo:"/login"})}]),angular.module("EvalApp").constant("SERVER_URL","http://dispatch.ru.is/h22/api/v1/"),angular.module("EvalApp").controller("AdminController",["$scope","LoginResource","MyResource","$location",function(a,b){b.getToken()}]),angular.module("EvalApp").directive("evaluationQuestion",function(){return{restrict:"E",scope:{question:"ngModel"},templateUrl:"views/evaluationQuestion.tpl.html",link:function(){}}}),angular.module("EvalApp").controller("LoginController",["$scope","LoginResource","$location",function(a,b){a.user="",a.pass="",a.login=function(){""!==a.user&&""!==a.pass?b.login(a.user,a.pass).success(function(a){console.log(JSON.stringify(a)),console.log(a.User.Username),b.setUser(a.User.Username),b.setToken(a.Token),b.setRole(a.User.Role),toastr.success(a.User.Username+" logged in!"),"student"===a.User.Role}).error(function(){toastr.error("Bad username or password!","Login error")}):toastr.error("Username or password empty!","Login error")}}]),angular.module("EvalApp").factory("LoginResource",["$http","SERVER_URL",function(a,b){var c="",d="",e="";return{login:function(c,d){var e={user:c,pass:d};return a.post(b+"login",e)},logout:function(){},isLoggedIn:function(){return""!==c?!0:!1},getUser:function(){return c},getToken:function(){return d},getRole:function(){return e},setUser:function(a){c=a},setToken:function(a){d=a},setRole:function(a){e=a}}}]),angular.module("EvalApp").factory("MyResource",["$http","SERVER_URL",function(a,b){var c="",d="";return{courses:function(e){return c="Basic "+e,d={headers:{Authorization:c}},a.get(b+"my/courses",d)}}}]),angular.module("EvalApp").controller("StudentController",["$scope","LoginResource","MyResource","$location",function(a,b,c){var d=b.getToken();a.courses=[],void 0!==d?(console.log(d),c.courses(d).success(function(b){console.log(b),a.courses=b,toastr.success("Fetched courses")}).error(function(){toastr.error("Something went wrong")})):toastr.error("Token undefined")}]);